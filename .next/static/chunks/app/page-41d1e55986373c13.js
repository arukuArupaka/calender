(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{3221:(e,t,i)=>{Promise.resolve().then(i.bind(i,3523))},3523:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>B});var a=i(5155),r=i(2115),n=i(3231),s=i(2944),l=i(7223),o=i(8882),c=i(7402),d=i(8885),u=i(79),p=i(6848),m=i(714),x=i(542),f=i(9708),y=i(2085),h=i(2596),g=i(9688);function v(){for(var e=arguments.length,t=Array(e),i=0;i<e;i++)t[i]=arguments[i];return(0,g.QP)((0,h.$)(t))}let b=(0,y.F)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),j=r.forwardRef((e,t)=>{let{className:i,variant:r,size:n,asChild:s=!1,...l}=e,o=s?f.DX:"button";return(0,a.jsx)(o,{className:v(b({variant:r,size:n,className:i})),ref:t,...l})});j.displayName="Button";let N=(0,y.F)("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function w(e){let{className:t,variant:i,...r}=e;return(0,a.jsx)("div",{className:v(N({variant:i}),t),...r})}var k=i(4416),P=i(9074),S=i(4516),C=i(8136);function E(e){let{event:t,onClose:i}=e,r=new Date(t.date);return(0,a.jsxs)("div",{className:"p-4",children:[(0,a.jsxs)("div",{className:"flex justify-between items-start mb-4",children:[(0,a.jsx)("h3",{className:"text-xl font-bold",children:t.title}),(0,a.jsx)(j,{variant:"ghost",size:"icon",onClick:i,children:(0,a.jsx)(k.A,{className:"h-4 w-4"})})]}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(P.A,{className:"h-4 w-4 text-muted-foreground"}),(0,a.jsx)("span",{children:(0,c.GP)(r,"yyyy年M月d日(E) HH:mm",{locale:d.ja})})]}),t.location&&(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(S.A,{className:"h-4 w-4 text-muted-foreground"}),(0,a.jsx)("span",{children:t.location})]}),t.company&&(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(C.A,{className:"h-4 w-4 text-muted-foreground"}),(0,a.jsx)("span",{children:t.company})]}),(0,a.jsxs)("div",{className:"flex flex-wrap gap-2",children:[(0,a.jsx)(w,{className:(e=>{switch(e){case"circle":return"bg-blue-100 text-blue-800";case"jobHunting":return"bg-green-100 text-green-800";case"university":return"bg-purple-100 text-purple-800";case"personal":return"bg-yellow-100 text-yellow-800";default:return"bg-gray-100 text-gray-800"}})(t.category),children:(e=>{switch(e){case"circle":return"サークル";case"jobHunting":return"就活";case"university":return"大学情報";case"personal":return"個人予定";default:return e}})(t.category)}),t.type&&(0,a.jsx)(w,{variant:"outline",children:t.type})]}),t.description&&(0,a.jsx)("div",{className:"mt-4 text-sm text-muted-foreground",children:(0,a.jsx)("p",{children:t.description})}),t.url&&(0,a.jsx)("div",{className:"flex justify-center items-center mt-2",children:(0,a.jsx)("a",{href:t.url,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:underline text-sm",children:"イベント詳細を見る"})}),(0,a.jsx)("div",{className:"flex justify-end gap-2 mt-4",children:(0,a.jsx)(j,{variant:"outline",onClick:()=>(function(e){let t=new Date(e.date),i=new Date(t);i.setHours(i.getHours()+1);let a=t.toISOString().replace(/-|:|\.\d+/g,""),r=i.toISOString().replace(/-|:|\.\d+/g,""),n=new URL("https://www.google.com/calendar/render");n.searchParams.append("action","TEMPLATE"),n.searchParams.append("text",e.title),e.description&&n.searchParams.append("details",e.description),e.location&&n.searchParams.append("location",e.location),n.searchParams.append("dates","".concat(a,"/").concat(r)),window.open(n.toString(),"_blank")})(t),children:"Googleカレンダーに追加"})})]})]})}var A=i(6183),T=i(760);function _(e){let{currentDate:t,events:i}=e,[l,o]=(0,r.useState)(null),d=(0,n.w)(t),f=(0,s.p)(t),y=(0,u.k)({start:d,end:f}),h=(0,p.P)(d),g=[];for(let e=0;e<h;e++)g.push((0,m.f)(d,e-h));g.push(...y);let b={};return i.forEach(e=>{let t=(0,c.GP)(new Date(e.date),"yyyy-MM-dd");b[t]||(b[t]=[]),b[t].push(e)}),Object.keys(b).forEach(e=>{b[e].sort((e,t)=>{let i=e.priority||0;return(t.priority||0)-i})}),(0,a.jsxs)("div",{className:"w-full overflow-hidden",children:[(0,a.jsx)("div",{className:"grid grid-cols-7 text-center mb-1",children:["日","月","火","水","木","金","土"].map((e,t)=>(0,a.jsx)("div",{className:v("text-sm font-medium py-1",0===t?"text-red-500":"",6===t?"text-blue-500":""),children:e},t))}),(0,a.jsx)("div",{className:"grid grid-cols-7 gap-px bg-gray-200 rounded-lg overflow-hidden",children:g.map((e,i)=>{let r=b[(0,c.GP)(e,"yyyy-MM-dd")]||[],n=(0,x.t)(e,t);return(0,a.jsxs)("div",{className:v("bg-white min-h-[100px] p-1",!n&&"opacity-40"),children:[(0,a.jsx)("div",{className:v("text-xs font-medium mb-1",0===(0,p.P)(e)?"text-red-500":"",6===(0,p.P)(e)?"text-blue-500":""),children:(0,c.GP)(e,"d")}),(0,a.jsxs)("div",{className:"space-y-1",children:[r.slice(0,3).map((e,t)=>(0,a.jsx)(A.P.div,{initial:{opacity:0,y:5},animate:{opacity:1,y:0},transition:{delay:.05*t},onClick:()=>o(e),className:v("text-xs rounded truncate cursor-pointer","circle"===e.category&&"bg-blue-100 text-blue-800","jobHunting"===e.category&&"bg-green-100 text-green-800","university"===e.category&&"bg-purple-100 text-purple-800","personal"===e.category&&"bg-yellow-100 text-yellow-800"),children:e.title},"".concat(e.id,"-").concat(t))),r.length>3&&(0,a.jsxs)("div",{className:"text-xs text-gray-500 font-medium",children:["+",r.length-3,"件"]})]})]},i)})}),(0,a.jsx)(T.N,{children:l&&(0,a.jsx)(A.P.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black/50 flex items-center justify-center p-4 z-50",onClick:()=>o(null),children:(0,a.jsx)(A.P.div,{initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.9,opacity:0},className:"bg-white rounded-lg w-full max-w-md overflow-hidden",onClick:e=>e.stopPropagation(),children:(0,a.jsx)(E,{event:l,onClose:()=>o(null)})})})})]})}function V(e){let{activeTab:t,onTabChange:i}=e;return(0,a.jsx)("div",{className:"relative flex w-full border-b",children:(0,a.jsx)("div",{className:"flex w-full overflow-x-auto scrollbar-hide",children:[{id:"all",label:"すべて"},{id:"circle",label:"サークル"},{id:"jobHunting",label:"就活"},{id:"university",label:"大学情報"}].map(e=>(0,a.jsxs)("button",{onClick:()=>i(e.id),className:v("flex-1 px-1 py-2 text-sm font-medium relative whitespace-nowrap",t===e.id?"text-primary":"text-muted-foreground"),children:[e.label,t===e.id&&(0,a.jsx)(A.P.div,{layoutId:"activeTab",className:"absolute bottom-0 left-0 right-0 h-0.5 bg-primary",initial:!1,transition:{type:"spring",stiffness:500,damping:30}})]},e.id))})})}let H=r.forwardRef((e,t)=>{let{className:i,type:r,...n}=e;return(0,a.jsx)("input",{type:r,className:v("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",i),ref:t,...n})});H.displayName="Input";let O=r.forwardRef((e,t)=>{let{className:i,...r}=e;return(0,a.jsx)("textarea",{className:v("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",i),ref:t,...r})});O.displayName="Textarea";var D=i(968);let M=(0,y.F)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),F=r.forwardRef((e,t)=>{let{className:i,...r}=e;return(0,a.jsx)(D.b,{ref:t,className:v(M(),i),...r})});function I(e){let{onSubmit:t,onCancel:i}=e,[n,s]=(0,r.useState)({title:"",date:"",time:"",description:"",location:"",type:""}),l=e=>{let{name:t,value:i}=e.target;s(e=>({...e,[t]:i}))};return(0,a.jsx)(A.P.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black/50 flex items-center justify-center p-4 z-50",onClick:i,children:(0,a.jsxs)(A.P.div,{initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.9,opacity:0},className:"bg-white rounded-lg w-full max-w-md overflow-hidden",onClick:e=>e.stopPropagation(),children:[(0,a.jsxs)("div",{className:"flex justify-between items-center p-4 border-b",children:[(0,a.jsx)("h3",{className:"text-lg font-medium",children:"予定を追加"}),(0,a.jsx)(j,{variant:"ghost",size:"icon",onClick:i,children:(0,a.jsx)(k.A,{className:"h-4 w-4"})})]}),(0,a.jsxs)("form",{onSubmit:e=>{e.preventDefault();let i=n.time?"".concat(n.date,"T").concat(n.time,":00"):"".concat(n.date,"T00:00:00");t({id:"user-".concat(Date.now()),title:n.title,date:i,description:n.description,location:n.location,type:n.type||"個人",category:"personal",priority:50})},className:"p-4 space-y-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(F,{htmlFor:"title",children:"タイトル"}),(0,a.jsx)(H,{id:"title",name:"title",value:n.title,onChange:l,required:!0})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(F,{htmlFor:"date",children:"日付"}),(0,a.jsx)(H,{id:"date",name:"date",type:"date",value:n.date,onChange:l,required:!0})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(F,{htmlFor:"time",children:"時間"}),(0,a.jsx)(H,{id:"time",name:"time",type:"time",value:n.time,onChange:l})]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(F,{htmlFor:"location",children:"場所"}),(0,a.jsx)(H,{id:"location",name:"location",value:n.location,onChange:l})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(F,{htmlFor:"type",children:"種別"}),(0,a.jsx)(H,{id:"type",name:"type",value:n.type,onChange:l,placeholder:"例: 勉強会、ミーティング"})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(F,{htmlFor:"description",children:"詳細"}),(0,a.jsx)(O,{id:"description",name:"description",value:n.description,onChange:l,rows:3})]}),(0,a.jsxs)("div",{className:"flex justify-end gap-2 pt-2",children:[(0,a.jsx)(j,{type:"button",variant:"outline",onClick:i,children:"キャンセル"}),(0,a.jsx)(j,{type:"submit",children:"保存"})]})]})]})})}F.displayName=D.b.displayName;var R=i(1154),G=i(4616);let z={circle:"https://firestore.googleapis.com/v1/projects/circle-calendar-kaihatu/databases/(default)/documents/event",jobHunting:"https://firestore.googleapis.com/v1/projects/jobhuntingevents/databases/(default)/documents/event",university:"https://firestore.googleapis.com/v1/projects/universityevents-c12a1/databases/(default)/documents/event"};async function L(e,t){let i=(0,c.GP)(e,"yyyy-MM-dd'T'00:00:00'Z'"),a=(0,c.GP)(t,"yyyy-MM-dd'T'23:59:59'Z'"),r=Object.entries(z).map(async e=>{let[t,r]=e,n={structuredQuery:{from:[{collectionId:"event"}],where:{compositeFilter:{op:"AND",filters:[{fieldFilter:{field:{fieldPath:"date"},op:"GREATER_THAN_OR_EQUAL",value:{timestampValue:i}}},{fieldFilter:{field:{fieldPath:"date"},op:"LESS_THAN_OR_EQUAL",value:{timestampValue:a}}}]}},orderBy:[{field:{fieldPath:"date"},direction:"ASCENDING"}]}};try{let e=await fetch("".concat(r.split("/documents")[0],"/documents:runQuery"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)});if(!e.ok)throw Error("Error fetching ".concat(t," events: ").concat(e.statusText));return(await e.json()).filter(e=>e.document).map(e=>{var i,a,r,n,s,l,o,c,d;let u=e.document.fields;return{id:e.document.name.split("/").pop(),title:(null===(i=u.title)||void 0===i?void 0:i.stringValue)||"Untitled",date:(null===(a=u.date)||void 0===a?void 0:a.timestampValue)||new Date().toISOString(),description:(null===(r=u.description)||void 0===r?void 0:r.stringValue)||"",location:(null===(n=u.location)||void 0===n?void 0:n.stringValue)||"",company:(null===(s=u.company)||void 0===s?void 0:s.stringValue)||"",type:(null===(l=u.type)||void 0===l?void 0:l.stringValue)||"",url:(null===(o=u.url)||void 0===o?void 0:o.stringValue)||"",category:t,priority:(null===(c=u.priority)||void 0===c?void 0:c.integerValue)?Number.parseInt(u.priority.integerValue):(null===(d=u.priority)||void 0===d?void 0:d.doubleValue)||0}})}catch(e){return console.error("Error fetching ".concat(t," events:"),e),[]}});return(await Promise.all(r)).flat()}var Q=i(5659);let J=r.forwardRef((e,t)=>{let{className:i,children:r,...n}=e;return(0,a.jsxs)(Q.bL,{ref:t,className:v("relative overflow-hidden",i),...n,children:[(0,a.jsx)(Q.LM,{className:"h-full w-full rounded-[inherit]",children:r}),(0,a.jsx)(U,{}),(0,a.jsx)(Q.OK,{})]})});J.displayName=Q.bL.displayName;let U=r.forwardRef((e,t)=>{let{className:i,orientation:r="vertical",...n}=e;return(0,a.jsx)(Q.VM,{ref:t,orientation:r,className:v("flex touch-none select-none transition-colors","vertical"===r&&"h-full w-2.5 border-l border-l-transparent p-[1px]","horizontal"===r&&"h-2.5 flex-col border-t border-t-transparent p-[1px]",i),...n,children:(0,a.jsx)(Q.lr,{className:"relative flex-1 rounded-full bg-border"})})});function q(e){let{types:t,selectedTypes:i,onTypeSelect:r}=e;return 0===t.length?null:(0,a.jsx)(J,{className:"w-full whitespace-nowrap px-4 py-2",children:(0,a.jsx)("div",{className:"flex gap-2",children:t.map(e=>(0,a.jsx)(A.P.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},transition:{duration:.2},children:(0,a.jsx)(w,{variant:i.includes(e)?"default":"outline",className:"cursor-pointer",onClick:()=>r(e),children:e})},e))})})}function B(){let[e,t]=(0,r.useState)(new Date),[i,u]=(0,r.useState)([]),[p,m]=(0,r.useState)([]),[x,f]=(0,r.useState)(!0),[y,h]=(0,r.useState)("all"),[g,v]=(0,r.useState)(!1),[b,N]=(0,r.useState)([]),[w,k]=(0,r.useState)({all:[],circle:[],jobHunting:[],university:[]});return(0,r.useEffect)(()=>{(async()=>{f(!0);try{let t=(0,n.w)(e),i=(0,s.p)(e),a=await L(t,i),r=localStorage.getItem("userEvents"),l=(r?JSON.parse(r):[]).filter(e=>{let a=new Date(e.date);return a>=t&&a<=i}),o=[...a,...l];u(o);let c={all:new Set,circle:new Set,jobHunting:new Set,university:new Set};o.forEach(e=>{e.type&&(c[e.category].add(e.type),c.all.add(e.type))}),k({all:Array.from(c.all),circle:Array.from(c.circle),jobHunting:Array.from(c.jobHunting),university:Array.from(c.university)})}catch(e){console.error("Error fetching events:",e)}finally{f(!1)}})()},[e]),(0,r.useEffect)(()=>{let e=[...i];"all"!==y&&(e=e.filter(e=>e.category===y||"personal"===e.category)),b.length>0&&(e=e.filter(e=>e.type&&b.includes(e.type))),m(e)},[i,y,b]),(0,a.jsx)("main",{className:"flex min-h-screen flex-col items-center",children:(0,a.jsxs)("div",{className:"w-full max-w-md mx-auto px-0 sm:px-4 pb-20",children:[(0,a.jsxs)("header",{className:"sticky top-0 bg-background z-10 pt-4 pb-2",children:[(0,a.jsx)(V,{activeTab:y,onTabChange:h}),(0,a.jsxs)("div",{className:"flex justify-between items-center mt-4 mb-2 px-4",children:[(0,a.jsx)(j,{variant:"ghost",onClick:()=>{t(e=>(0,l.a)(e,1))},children:"<"}),(0,a.jsx)("h2",{className:"text-xl font-bold",children:(0,c.GP)(e,"yyyy年M月",{locale:d.ja})}),(0,a.jsx)(j,{variant:"ghost",onClick:()=>{t(e=>(0,o.P)(e,1))},children:">"})]}),(0,a.jsx)(q,{types:w[y],selectedTypes:b,onTypeSelect:e=>{N(t=>t.includes(e)?t.filter(t=>t!==e):[...t,e])}})]}),(0,a.jsx)(T.N,{mode:"wait",children:x?(0,a.jsx)(A.P.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"flex justify-center items-center h-64 w-full",children:(0,a.jsx)(R.A,{className:"h-12 w-12 animate-spin text-primary"})},"loader"):(0,a.jsx)(A.P.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},transition:{duration:.3},children:(0,a.jsx)(_,{currentDate:e,events:p})},"calendar")}),(0,a.jsx)(j,{className:"fixed bottom-6 right-6 rounded-full w-14 h-14 shadow-lg",onClick:()=>v(!0),children:(0,a.jsx)(G.A,{className:"h-6 w-6"})}),(0,a.jsx)(T.N,{children:g&&(0,a.jsx)(I,{onSubmit:t=>{let i=localStorage.getItem("userEvents"),a=[...i?JSON.parse(i):[],t];localStorage.setItem("userEvents",JSON.stringify(a));let r=new Date(t.date),l=(0,n.w)(e),o=(0,s.p)(e);r>=l&&r<=o&&u(e=>[...e,t]),v(!1)},onCancel:()=>v(!1)})})]})})}U.displayName=Q.VM.displayName}},e=>{var t=t=>e(e.s=t);e.O(0,[742,441,684,358],()=>t(3221)),_N_E=e.O()}]);